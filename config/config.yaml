# Broker Configuration
brokers:
  default: "alpaca"
  registry:
    simulation:
      type: "simulation"
      params: {}
    alpaca:
      type: "alpaca"
      params:
        paper: true
        data_feed: "iex"
        default_time_in_force: "gtc"
      credentials:
        api_key_env: "ALPACA_API_KEY"
        api_secret_env: "ALPACA_API_SECRET"

# Market Data Configuration
market_data:
  default_provider: "yfinance"  # yfinance, alpha_vantage, quandl
  
  # API Keys are now loaded from environment variables:
  # - ALPHA_VANTAGE_API_KEY
  # - QUANDL_API_KEY
  
  # Data storage
  database_url: "sqlite:///src/tradingagent/dataaccess/db/market_data.db"
  
  # Default symbols to track
  default_symbols:
    - "AAPL"
    - "GOOGL"
    - "MSFT"
    - "TSLA"
    - "SPY"

# Trading Configuration
trading:
  # Default parameters
  initial_capital: 100000.0
  commission: 0.001  # 0.1% per trade
  slippage: 0.0005   # 0.05% slippage
  
  # Risk management
  max_position_size: 0.1  # Maximum 10% per position
  max_portfolio_risk: 0.02  # Maximum 2% portfolio risk per trade
  stop_loss_pct: 0.05  # 5% stop loss
  take_profit_pct: 0.15  # 15% take profit

automation:
  trading_window:
    enabled: true
    timezone: "America/New_York"
    weekdays: [0, 1, 2, 3, 4]  # Monday = 0
    start: "09:30"
    end: "16:00"
    grace_minutes: 0
    holidays: []  # Optional list of YYYY-MM-DD strings
  broker_risk_limits:
    enabled: true
    strict: true
    portfolio:
      max_gross_exposure: 500000        # Absolute gross exposure cap across all symbols
      max_symbol_percent: 0.25          # Any single symbol <= 25% of total equity
      max_position_count: 15            # Maximum open symbols at once
      max_single_order_notional: 150000 # Cap per order notional
    per_symbol:
      default:
        max_position_qty: 1000
        max_position_notional: 250000
        max_order_notional: 100000
      AAPL:
        max_position_qty: 500
        max_position_notional: 120000
        max_order_notional: 60000
      TSLA:
        max_position_qty: 300
        max_position_notional: 90000
        max_order_notional: 50000

# Backtesting Configuration
backtesting:
  start_date: "2022-01-01"
  end_date: "2022-12-31"
  initial_capital: 100000
  symbols: ["AAPL", "MSFT"]
  strategy: "mean_reversion"
  
  # Performance metrics
  risk_free_rate: 0.02  # 2% annual risk-free rate
  
# Risk Management
risk_management:
  var_confidence: 0.95  # 95% confidence for VaR
  var_lookback_days: 252  # 1 year lookback
  max_correlation: 0.7  # Maximum correlation between positions
  
  # Position sizing
  volatility_lookback: 30  # Days for volatility calculation
  volatility_target: 0.15  # 15% annual volatility target

# Logging Configuration
logging:
  level: "INFO"
  file: "./logs/trading.log"
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
